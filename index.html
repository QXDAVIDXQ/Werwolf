<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>üê∫ Werw√∂lfe ‚Äì Einfache Version</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 15px; background: #fdf6e3; }
    .section { background: white; padding: 15px; margin: 15px 0; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    input, button, select { padding: 8px; margin: 5px; font-size: 15px; }
    button { background: #2e7d32; color: white; border: none; border-radius: 4px; cursor: pointer; }
    button:disabled { background: #bdbdbd; cursor: not-allowed; }
    .rolle { display: inline-block; margin: 5px; padding: 8px; background: #e8f5e8; border: 1px solid #4caf50; border-radius: 4px; cursor: pointer; }
    .rolle.active { background: #c8e6c9; font-weight: bold; }
    .phase { display: none; }
    .phase.active { display: block; }
    .spieler { display: inline-block; margin: 4px; padding: 6px; background: #e3f2fd; border-radius: 4px; }
    .tot { opacity: 0.5; text-decoration: line-through; }
  </style>
</head>
<body>

<h1>üê∫ Werw√∂lfe von D√ºsterwald</h1>

<!-- SETUP -->
<div id="setup" class="phase active">
  <div class="section">
    <h2>1. Spielerzahl (6‚Äì24)</h2>
    <input type="number" id="anzahl" min="6" max="24" value="8">
  </div>

  <div class="section">
    <h2>2. Namen eingeben</h2>
    <div id="namen"></div>
  </div>

  <div class="section">
    <h2>3. Rollen ausw√§hlen</h2>
    <p>Gesamt: <span id="gesamt">0</span> / <span id="ziel">8</span></p>
    <div id="rollen"></div>
  </div>

  <button id="start" disabled>‚ñ∂Ô∏è Spiel starten</button>
</div>

<!-- SPIEL -->
<div id="spiel" class="phase">
  <div class="section">
    <h2 id="phaseTitel">Nacht 1</h2>
    <div id="inhalt"></div>
    <button id="weiter" style="display:none;">Weiter</button>
  </div>

  <div class="section">
    <h3>Lebende Spieler</h3>
    <div id="lebende"></div>
  </div>
</div>

<script>
// ===== ROLLEN (nur die von dir genannten) =====
const rollenListe = [
  { id: 'werwolf', name: 'Einfache Werw√∂lfe', count: 0, size: 1 },
  { id: 'urwolf', name: 'Der Urwolf', count: 0, size: 1 },
  { id: 'grosser_wolf', name: 'Der gro√üe, b√∂se Wolf', count: 0, size: 1 },
  { id: 'dorfbewohner', name: 'Einfache Dorfbewohner', count: 0, size: 1 },
  { id: 'amor', name: 'Amor', count: 0, size: 1 },
  { id: 'seherin', name: 'Die Seherin', count: 0, size: 1 },
  { id: 'schwestern', name: 'Die zwei Schwestern', count: 0, size: 2 }, // z√§hlt als 2!
  { id: 'maedchen', name: 'Das kleine M√§dchen', count: 0, size: 1 },
  { id: 'fuchs', name: 'Der Fuchs', count: 0, size: 1 },
  { id: 'ritter', name: 'Der Ritter', count: 0, size: 1 },
  { id: 'alte', name: 'Der Alte', count: 0, size: 1 },
  { id: 'hexe', name: 'Die Hexe', count: 0, size: 1 },
  { id: 'baer', name: 'Der B√§renf√ºhrer', count: 0, size: 1 },
  { id: 'jaeger', name: 'Der J√§ger', count: 0, size: 1 },
  { id: 'wilde_kind', name: 'Das wilde Kind', count: 0, size: 1 },
  { id: 'wolfshund', name: 'Der Wolfshund', count: 0, size: 1 },
  { id: 'weisser_wolf', name: 'Der wei√üe Werwolf', count: 0, size: 1 },
  { id: 'floete', name: 'Der Fl√∂tenspieler', count: 0, size: 1 },
  { id: 'engel', name: 'Der Engel', count: 0, size: 1 }
];

let spieler = [];
let aktuelleNacht = 1;
let werwolfOpfer = null;
let grosserWolfOpfer = null;
let maedchenEntdeckt = false;

// ===== SETUP =====
document.getElementById('anzahl').addEventListener('input', updateNamen);
function updateNamen() {
  const n = Math.max(6, Math.min(24, parseInt(this.value) || 8));
  this.value = n;
  document.getElementById('ziel').textContent = n;
  
  let html = '';
  for (let i = 1; i <= n; i++) {
    html += `<div><label>Spieler ${i}:</label> <input type="text" id="p${i}" value="Spieler ${i}"></div>`;
  }
  document.getElementById('namen').innerHTML = html;
  updateGesamt();
}

// Rollen-Buttons
const rollenDiv = document.getElementById('rollen');
rollenListe.forEach(rolle => {
  const div = document.createElement('div');
  div.className = 'rolle';
  div.textContent = `${rolle.name} (0)`;
  div.onclick = () => {
    rolle.count++;
    renderRollen();
    updateGesamt();
  };
  div.dataset.id = rolle.id;
  rollenDiv.appendChild(div);
});

function renderRollen() {
  rollenListe.forEach(rolle => {
    const div = document.querySelector(`[data-id="${rolle.id}"]`);
    div.textContent = `${rolle.name} (${rolle.count})`;
    div.classList.toggle('active', rolle.count > 0);
  });
}

function updateGesamt() {
  const ziel = parseInt(document.getElementById('ziel').textContent);
  const gesamt = rollenListe.reduce((sum, r) => sum + r.count * r.size, 0);
  document.getElementById('gesamt').textContent = gesamt;
  document.getElementById('start').disabled = (gesamt !== ziel);
}

// Start
document.getElementById('start').addEventListener('click', startSpiel);
function startSpiel() {
  const n = parseInt(document.getElementById('ziel').textContent);
  
  // Namen sammeln
  spieler = [];
  let id = 1;
  for (let i = 1; i <= n; i++) {
    const name = document.getElementById(`p${i}`)?.value || `Spieler ${i}`;
    spieler.push({ id, name, lebend: true, rolle: null });
    id++;
  }

  // Rollen zuweisen
  let idx = 0;
  rollenListe.forEach(r => {
    for (let i = 0; i < r.count; i++) {
      if (r.size === 2) {
        // Zwei Schwestern = 2 Spieler
        if (idx < spieler.length) spieler[idx++].rolle = r.id;
        if (idx < spieler.length) spieler[idx++].rolle = r.id;
      } else {
        if (idx < spieler.length) spieler[idx++].rolle = r.id;
      }
    }
  });

  // Spiel starten
  <script>
// ... (dein bestehender Code bis zu startSpiel bleibt gleich)

// START SPIEL ‚Äì aktualisiert
function startSpiel() {
  const n = parseInt(document.getElementById('ziel').textContent);
  
  // Namen sammeln
  spieler = [];
  let id = 1;
  for (let i = 1; i <= n; i++) {
    const name = document.getElementById(`p${i}`)?.value || `Spieler ${i}`;
    // Finde die passende Rollen-Beschreibung f√ºr Anzeige
    const rolleObj = rollenListe.find(r => r.id === getRolleById(id));
    const rolleName = rolleObj ? rolleObj.name : "Unbekannt";
    spieler.push({ id, name, lebend: true, rolle: getRolleById(id), rolleName });
    id++;
  }

  // Spiel starten
  document.getElementById('setup').classList.remove('active');
  document.getElementById('spiel').classList.add('active');
  
  // üî• NEU: Zuerst Rollen verteilen!
  aktuellerSpielerIndex = 0;
  zeigeRollenPhase();
}

// Hilfsfunktion: Welche Rolle hat Spieler mit ID?
let rollenZuweisung = [];
function getRolleById(id) {
  // Rollen zuweisen (wie vorher, aber speichern)
  if (rollenZuweisung.length === 0) {
    let idx = 0;
    rollenListe.forEach(r => {
      for (let i = 0; i < r.count; i++) {
        if (r.size === 2) {
          if (idx < spieler.length) rollenZuweisung.push(r.id);
          if (idx < spieler.length) rollenZuweisung.push(r.id);
          idx += 2;
        } else {
          if (idx < spieler.length) rollenZuweisung.push(r.id);
          idx++;
        }
      }
    });
  }
  return rollenZuweisung[id - 1] || 'dorfbewohner';
}

// üî• NEUE PHASE: Rollen geheim anzeigen
let aktuellerSpielerIndex = 0;

function zeigeRollenPhase() {
  if (aktuellerSpielerIndex >= spieler.length) {
    // Alle haben ihre Rolle gesehen ‚Üí Nacht 1 starten
    aktuelleNacht = 1;
    naechstePhase('nacht');
    return;
  }

  const spielerAktuell = spieler[aktuellerSpielerIndex];
  document.getElementById('phaseTitel').textContent = `Deine Rolle`;
  
  let html = `<h3>${spielerAktuell.name}</h3>`;
  html += `<p>Dr√ºcke auf ‚ÄûAnzeigen‚Äú, um deine Rolle zu sehen.</p>`;
  html += `<button id="btn-anzeigen">anzeigen</button>`;
  html += `<div id="rolle-anzeige" style="margin-top:15px; padding:10px; background:#f5f5f5; display:none;"></div>`;
  html += `<button id="btn-weiter" style="display:none; margin-top:10px;">Weiter (Rolle gesehen)</button>`;

  document.getElementById('inhalt').innerHTML = html;
  document.getElementById('weiter').style.display = 'none';

  // Anzeigen-Button
  document.getElementById('btn-anzeigen').onclick = () => {
    document.getElementById('rolle-anzeige').textContent = `Du bist: ${spielerAktuell.rolleName}`;
    document.getElementById('rolle-anzeige').style.display = 'block';
    document.getElementById('btn-weiter').style.display = 'inline-block';
  };

  // Weiter-Button
  document.getElementById('btn-weiter').onclick = () => {
    aktuellerSpielerIndex++;
    zeigeRollenPhase();
  };
}

// ... (der Rest deines Codes ‚Äì naechstePhase, hinrichten, etc. ‚Äì bleibt gleich)
</script>
}

// ===== SPIELPHASEN =====
function naechstePhase(phase) {
  if (phase === 'nacht') {
    document.getElementById('phaseTitel').textContent = `Nacht ${aktuelleNacht}`;
    
    let html = `<p><strong>Werw√∂lfe:</strong> Wen t√∂tet ihr?</p>`;
    html += `<select id="opfer1">`;
    spieler.filter(p => p.lebend).forEach(p => {
      html += `<option value="${p.id}">${p.name}</option>`;
    });
    html += `</select>`;

    // Gro√üer Wolf: jede 2. Nacht
    if (aktuelleNacht % 2 === 0) {
      const hatGrossenWolf = spieler.some(p => p.lebend && p.rolle === 'grosser_wolf');
      if (hatGrossenWolf) {
        html += `<p><strong>Gro√üer b√∂ser Wolf:</strong> Zweites Opfer?</p>`;
        html += `<select id="opfer2">`;
        spieler.filter(p => p.lebend).forEach(p => {
          html += `<option value="${p.id}">${p.name}</option>`;
        });
        html += `</select>`;
      }
    }

    // Kleines M√§dchen
    const hatMaedchen = spieler.some(p => p.lebend && p.rolle === 'maedchen');
    if (hatMaedchen) {
      html += `<p><strong>Nachdem die Werw√∂lfe eingeschlafen sind:</strong><br>
               Wurde das kleine M√§dchen entdeckt?</p>
               <label><input type="radio" name="maedchen" value="nein" checked> Nein</label>
               <label><input type="radio" name="maedchen" value="ja"> Ja</label>`;
    }

    document.getElementById('inhalt').innerHTML = html;
    document.getElementById('weiter').style.display = 'inline-block';
    document.getElementById('weiter').onclick = () => {
      werwolfOpfer = parseInt(document.getElementById('opfer1')?.value || '0');
      grosserWolfOpfer = parseInt(document.getElementById('opfer2')?.value || '0');
      maedchenEntdeckt = document.querySelector('input[name="maedchen"]:checked')?.value === 'ja';
      
      // Tode anwenden
      if (werwolfOpfer) {
        const p = spieler.find(x => x.id === werwolfOpfer);
        if (p) p.lebend = false;
      }
      if (grosserWolfOpfer) {
        const p = spieler.find(x => x.id === grosserWolfOpfer);
        if (p) p.lebend = false;
      }
      if (maedchenEntdeckt) {
        const p = spieler.find(x => x.rolle === 'maedchen');
        if (p) p.lebend = false;
      }

      naechstePhase('tag');
    };
  }

  else if (phase === 'tag') {
    document.getElementById('phaseTitel').textContent = `Tag ${aktuelleNacht}`;
    
    const tote = spieler.filter(p => !p.lebend);
    let html = `<p><strong>Tote der Nacht:</strong> `;
    if (tote.length > 0) {
      html += tote.map(p => p.name).join(', ');
    } else {
      html += 'Keine.';
    }
    html += `</p>`;

    html += `<p><strong>Hinrichtung:</strong> Wen beschuldigt das Dorf?</p>`;
    html += `<select id="hinrichtung">`;
    spieler.filter(p => p.lebend).forEach(p => {
      html += `<option value="${p.id}">${p.name}</option>`;
    });
    html += `</select>`;
    html += `<button onclick="hinrichten()">Hinrichten</button>`;

    document.getElementById('inhalt').innerHTML = html;
    document.getElementById('weiter').style.display = 'none';
  }

  renderLebende();
}

function hinrichten() {
  const id = parseInt(document.getElementById('hinrichtung').value);
  const p = spieler.find(x => x.id === id);
  if (p) p.lebend = false;

  // Pr√ºfe Sieg (vereinfacht)
  const boese = spieler.filter(p => p.lebend && ['werwolf','urwolf','grosser_wolf','weisser_wolf'].includes(p.rolle));
  const gut = spieler.filter(p => p.lebend && !['werwolf','urwolf','grosser_wolf','weisser_wolf'].includes(p.rolle));

  if (boese.length === 0) {
    document.getElementById('inhalt').innerHTML = `<h3>üéâ Das Dorf gewinnt!</h3>`;
  } else if (boese.length >= gut.length) {
    document.getElementById('inhalt').innerHTML = `<h3>üåë Die Werw√∂lfe gewinnen!</h3>`;
  } else {
    aktuelleNacht++;
    naechstePhase('nacht');
  }
  renderLebende();
}

function renderLebende() {
  const div = document.getElementById('lebende');
  div.innerHTML = '';
  spieler.filter(p => p.lebend).forEach(p => {
    const span = document.createElement('span');
    span.className = 'spieler';
    span.textContent = p.name;
    div.appendChild(span);
  });
}

// Init
updateNamen();
</script>

</body>
</html>
